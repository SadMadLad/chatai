<%= turbo_frame_tag 'chat', class: 'h-full', data: { action: 'turbo:before-frame-render->chats#activateChatTab', id: @chat.id } do %>
  <%= turbo_stream_from chat %>

  <div class="flex flex-col justify-between h-full">
    <% if chat.two_person? %>
      <header class="z-40 sticky top-0 rounded-lg shadow-sm bg-white px-4 py-2.5 border-b flex justify-between items-center">
        <div class="flex items-center gap-2.5">
          <%= account_avatar(current_account) %>
          <p class="text-xl font-bold"><%= @other_account.full_name %></p>
        </div>
        <i class="fas fa-info-circle text-primary-500 cursor-pointer fa-xl"></i>
      </header>
    <% end %>

    <div
      id=<%= dom_id(chat) %>
      class="px-4 flex flex-col gap-3 py-8"
      data-controller="scroll"
      data-scroll-target="scrollContainer"
      data-scroll-scrollable-into-view-value="true"
      data-scroll-scroll-container-to-bottom-value="true"
    >
      <%= render partial: 'messages/message', collection: messages, locals: { scroll_into_view: false } %>
    </div>

    <%= render 'messages/form', chat:, message: %>
  </div>
<% end %>
